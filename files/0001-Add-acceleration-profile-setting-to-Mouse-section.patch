From fbaf4429d64578a1d0a26f7f7cbc94dfdf61771d Mon Sep 17 00:00:00 2001
From: Campbell Jones <git@serebit.com>
Date: Wed, 22 Sep 2021 15:39:03 -0400
Subject: [PATCH] Add acceleration profile setting to Mouse section

---
 panels/mouse/cc-mouse-panel.c  |  6 ++++++
 panels/mouse/cc-mouse-panel.ui | 21 +++++++++++++++++++++
 2 files changed, 27 insertions(+)

diff --git a/panels/mouse/cc-mouse-panel.c b/panels/mouse/cc-mouse-panel.c
index ddf3fc1a8..2b2ec99f0 100644
--- a/panels/mouse/cc-mouse-panel.c
+++ b/panels/mouse/cc-mouse-panel.c
@@ -42,6 +42,7 @@ struct _CcMousePanel
   GtkFrame          *mouse_frame;
   GtkListBox        *mouse_listbox;
   GtkSwitch         *mouse_natural_scrolling_switch;
+  GtkComboBox       *mouse_acceleration_profile_box;
   GtkScale          *mouse_speed_scale;
   CcMouseTest       *mouse_test;
   GtkBox            *primary_button_box;
@@ -227,6 +228,10 @@ setup_dialog (CcMousePanel *self)
   self->left_gesture = gtk_gesture_multi_press_new (GTK_WIDGET (button));
   handle_secondary_button (self, button, self->left_gesture);
 
+  g_settings_bind (self->mouse_settings, "accel-profile",
+       self->mouse_acceleration_profile_box, "active-id",
+       G_SETTINGS_BIND_DEFAULT);
+
   g_settings_bind (self->mouse_settings, "natural-scroll",
        self->mouse_natural_scrolling_switch, "active",
        G_SETTINGS_BIND_DEFAULT);
@@ -421,6 +426,7 @@ cc_mouse_panel_class_init (CcMousePanelClass *klass)
   gtk_widget_class_bind_template_child (widget_class, CcMousePanel, mouse_frame);
   gtk_widget_class_bind_template_child (widget_class, CcMousePanel, mouse_listbox);
   gtk_widget_class_bind_template_child (widget_class, CcMousePanel, mouse_natural_scrolling_switch);
+  gtk_widget_class_bind_template_child (widget_class, CcMousePanel, mouse_acceleration_profile_box);
   gtk_widget_class_bind_template_child (widget_class, CcMousePanel, mouse_speed_scale);
   gtk_widget_class_bind_template_child (widget_class, CcMousePanel, mouse_test);
   gtk_widget_class_bind_template_child (widget_class, CcMousePanel, primary_button_box);
diff --git a/panels/mouse/cc-mouse-panel.ui b/panels/mouse/cc-mouse-panel.ui
index 883666361..64e922127 100644
--- a/panels/mouse/cc-mouse-panel.ui
+++ b/panels/mouse/cc-mouse-panel.ui
@@ -158,6 +158,27 @@
                             </child>
                           </object>
                         </child>
+                        <child>
+                          <object class="HdyActionRow" id="mouse_acceleration_row">
+                            <property name="visible">True</property>
+                            <property name="can_focus">True</property>
+                            <property name="activatable">false</property>
+                            <property name="title" translatable="yes">Acceleration Profile</property>
+                            <property name="subtitle" translatable="yes">How the pointer moves when you move the mouse.</property>
+                            <child>
+                              <object class="GtkComboBoxText" id="mouse_acceleration_profile_box">
+                                <property name="visible">True</property>
+                                <property name="can_focus">False</property>
+                                <property name="valign">center</property>
+                                <items>
+                                  <item id="default" translatable="yes">Default</item>
+                                  <item id="flat" translatable="yes">Flat</item>
+                                  <item id="adaptive" translatable="yes">Adaptive</item>
+                                </items>
+                              </object>
+                            </child>
+                          </object>
+                        </child>
                         <child>
                           <object class="HdyActionRow" id="mouse_natural_scrolling_row">
                             <property name="visible">True</property>
-- 
2.32.0

