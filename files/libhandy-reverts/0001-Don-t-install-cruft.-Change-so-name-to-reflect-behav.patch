From 6ce0ff740d85026b607b96eb09f131f30892760d Mon Sep 17 00:00:00 2001
From: Joshua Strobl <joshua@streambits.io>
Date: Thu, 12 Nov 2020 18:51:43 +0200
Subject: [PATCH 1/1] Don't install cruft. Change so name to reflect behaviour.

---
 meson.build     |  3 --
 src/meson.build | 81 ++++++++-----------------------------------------
 2 files changed, 13 insertions(+), 71 deletions(-)

diff --git a/meson.build b/meson.build
index aae0533..822da5d 100644
--- a/meson.build
+++ b/meson.build
@@ -123,9 +123,6 @@ introspection = introspection_feature.enabled() or introspection_feature.auto()
 gnome = import('gnome')
 
 subdir('src')
-subdir('po')
-subdir('examples')
-subdir('tests')
 subdir('doc')
 subdir('glade')
 
diff --git a/src/meson.build b/src/meson.build
index 11d4100..fe5c76c 100644
--- a/src/meson.build
+++ b/src/meson.build
@@ -31,15 +31,12 @@ hdy_version_h = configure_file(
            input: 'hdy-version.h.in',
           output: 'hdy-version.h',
      install_dir: libhandy_header_dir,
-         install: true,
+         install: false,
    configuration: version_data)
 
 libhandy_generated_headers = [
 ]
 
-install_headers(['handy.h'],
-  subdir: libhandy_header_subdir)
-
 # Filled out in the subdirs
 libhandy_public_headers = []
 libhandy_public_sources = []
@@ -49,7 +46,7 @@ hdy_public_enums = gnome.mkenums('hdy-enums',
       h_template: 'hdy-enums.h.in',
       c_template: 'hdy-enums.c.in',
          sources: hdy_public_enum_headers,
-  install_header: true,
+  install_header: false,
      install_dir: libhandy_header_dir,
 )
 
@@ -164,9 +161,6 @@ src_sources = [
 libhandy_public_headers += files(src_headers)
 libhandy_public_sources += files(src_sources)
 
-install_headers(src_headers, subdir: libhandy_header_subdir)
-
-
 libhandy_sources = [
   libhandy_generated_headers,
   libhandy_public_sources,
@@ -229,16 +223,16 @@ else
 endif
 
 libhandy = shared_library(
-  'handy-' + apiversion,
-  libhandy_sources,
-
-            soversion: soversion,
-               c_args: libhandy_c_args,
-         dependencies: libhandy_deps,
-  include_directories: [ root_inc, src_inc ],
-              install: true,
-            link_args: libhandy_link_args,
-          install_dir: handy_libdir,
+    'infesting-everything-' + apiversion,
+    libhandy_sources,
+
+    soversion: soversion,
+    c_args: libhandy_c_args,
+    dependencies: libhandy_deps,
+    include_directories: [ root_inc, src_inc ],
+    install: true,
+    link_args: libhandy_link_args,
+    install_dir: handy_libdir,
 )
 
 libhandy_dep = declare_dependency(
@@ -246,53 +240,4 @@ libhandy_dep = declare_dependency(
          dependencies: libhandy_deps,
             link_with: libhandy,
   include_directories: include_directories('.'),
-)
-
-if introspection
-
-   libhandy_gir_extra_args = [
-     '--c-include=handy.h',
-     '--quiet',
-     '-DHANDY_COMPILATION',
-   ]
-
-   libhandy_gir = gnome.generate_gir(libhandy,
-                 sources: libhandy_generated_headers + libhandy_public_headers + libhandy_public_sources,
-               nsversion: apiversion,
-               namespace: 'Handy',
-         export_packages: package_api_name,
-           symbol_prefix: 'hdy',
-       identifier_prefix: 'Hdy',
-               link_with: libhandy,
-                includes: ['Gio-2.0', 'Gtk-3.0'],
-                 install: true,
-         install_dir_gir: girdir,
-     install_dir_typelib: typelibdir,
-              extra_args: libhandy_gir_extra_args,
-   )
-
-   if get_option('vapi')
-
-     libhandy_vapi = gnome.generate_vapi(package_api_name,
-             sources: libhandy_gir[0],
-            packages: [ 'gio-2.0', 'gtk+-3.0' ],
-             install: true,
-         install_dir: vapidir,
-       metadata_dirs: [ meson.current_source_dir() ],
-     )
-
-   endif
-endif
-
-pkgg = import('pkgconfig')
-
-pkgg.generate(
-    libraries: [libhandy],
-      subdirs: libhandy_header_subdir,
-      version: meson.project_version(),
-         name: 'Handy',
-     filebase: package_api_name,
-  description: 'Handy Mobile widgets',
-     requires: 'gtk+-3.0',
-  install_dir: libdir / 'pkgconfig',
-)
+)
\ No newline at end of file
-- 
2.29.2

