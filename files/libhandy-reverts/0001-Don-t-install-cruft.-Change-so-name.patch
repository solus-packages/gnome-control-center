From 69ae5ccc1c15b31d8e3187a6326c3c5d8fd0fbfc Mon Sep 17 00:00:00 2001
From: Joshua Strobl <joshua@streambits.io>
Date: Sat, 2 Jan 2021 18:46:26 +0200
Subject: [PATCH 1/1] Don't install cruft. Change so name.

---
 meson.build     |  3 --
 src/meson.build | 77 +++++++------------------------------------------
 2 files changed, 10 insertions(+), 70 deletions(-)

diff --git a/meson.build b/meson.build
index 009769c..25106e0 100644
--- a/meson.build
+++ b/meson.build
@@ -123,9 +123,6 @@ introspection = introspection_feature.enabled() or introspection_feature.auto()
 gnome = import('gnome')
 
 subdir('src')
-subdir('po')
-subdir('examples')
-subdir('tests')
 subdir('doc')
 subdir('glade')
 
diff --git a/src/meson.build b/src/meson.build
index 3e1c181..7040aef 100644
--- a/src/meson.build
+++ b/src/meson.build
@@ -30,15 +30,11 @@ version_data.set('HDY_VERSION', meson.project_version())
 hdy_version_h = configure_file(
            input: 'hdy-version.h.in',
           output: 'hdy-version.h',
-     install_dir: libhandy_header_dir,
    configuration: version_data)
 
 libhandy_generated_headers = [
 ]
 
-install_headers(['handy.h'],
-  subdir: libhandy_header_subdir)
-
 # Filled out in the subdirs
 libhandy_public_headers = []
 libhandy_public_sources = []
@@ -48,7 +44,7 @@ hdy_public_enums = gnome.mkenums('hdy-enums',
       h_template: 'hdy-enums.h.in',
       c_template: 'hdy-enums.c.in',
          sources: hdy_public_enum_headers,
-  install_header: true,
+  install_header: false,
      install_dir: libhandy_header_dir,
 )
 
@@ -163,9 +159,6 @@ src_sources = [
 libhandy_public_headers += files(src_headers)
 libhandy_public_sources += files(src_sources)
 
-install_headers(src_headers, subdir: libhandy_header_subdir)
-
-
 libhandy_sources = [
   libhandy_generated_headers,
   libhandy_public_sources,
@@ -228,16 +221,15 @@ else
 endif
 
 libhandy = shared_library(
-  'handy-' + apiversion,
-  libhandy_sources,
-
-            soversion: soversion,
-               c_args: libhandy_c_args,
-         dependencies: libhandy_deps,
-  include_directories: [ root_inc, src_inc ],
-              install: true,
-            link_args: libhandy_link_args,
-          install_dir: handy_libdir,
+    'gccux-' + apiversion,
+    libhandy_sources,
+    soversion: soversion,
+    c_args: libhandy_c_args,
+    dependencies: libhandy_deps,
+    include_directories: [ root_inc, src_inc ],
+    install: true,
+    link_args: libhandy_link_args,
+    install_dir: handy_libdir,
 )
 
 libhandy_dep = declare_dependency(
@@ -246,52 +238,3 @@ libhandy_dep = declare_dependency(
             link_with: libhandy,
   include_directories: include_directories('.'),
 )
-
-if introspection
-
-   libhandy_gir_extra_args = [
-     '--c-include=handy.h',
-     '--quiet',
-     '-DHANDY_COMPILATION',
-   ]
-
-   libhandy_gir = gnome.generate_gir(libhandy,
-                 sources: libhandy_generated_headers + libhandy_public_headers + libhandy_public_sources,
-               nsversion: apiversion,
-               namespace: 'Handy',
-         export_packages: package_api_name,
-           symbol_prefix: 'hdy',
-       identifier_prefix: 'Hdy',
-               link_with: libhandy,
-                includes: ['Gio-2.0', 'Gtk-3.0'],
-                 install: true,
-         install_dir_gir: girdir,
-     install_dir_typelib: typelibdir,
-              extra_args: libhandy_gir_extra_args,
-   )
-
-   if get_option('vapi')
-
-     libhandy_vapi = gnome.generate_vapi(package_api_name,
-             sources: libhandy_gir[0],
-            packages: [ 'gio-2.0', 'gtk+-3.0' ],
-             install: true,
-         install_dir: vapidir,
-       metadata_dirs: [ meson.current_source_dir() ],
-     )
-
-   endif
-endif
-
-pkgg = import('pkgconfig')
-
-pkgg.generate(
-    libraries: [libhandy],
-      subdirs: libhandy_header_subdir,
-      version: meson.project_version(),
-         name: 'Handy',
-     filebase: package_api_name,
-  description: 'Handy Mobile widgets',
-     requires: 'gtk+-3.0',
-  install_dir: libdir / 'pkgconfig',
-)
-- 
2.30.0

